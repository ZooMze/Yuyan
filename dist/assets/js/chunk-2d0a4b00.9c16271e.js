(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a4b00"],{"0802":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"view-container"},[a("el-breadcrumb",[a("el-breadcrumb-item",[e._v("组织管理")])],1),a("div",{staticClass:"view-body"},[e.orgTreeData.length>0?a("el-tree",{attrs:{data:e.orgTreeData,props:e.defaultProps,"node-key":"department_id","default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,o=t.data;return a("div",{staticClass:"text-button-wrap",on:{mouseover:function(t){e.tempId=o.department_id},mouseout:function(t){e.tempId=null}}},[a("span",{staticClass:"fill-width"},[a("span",[e._v(e._s(n.label))]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.tempId==o.department_id,expression:"tempId == data.department_id"}]},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.showNodeDialog("new",o)}}},[e._v("\n              添加次级\n            ")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.showNodeDialog("edit",o)}}},[e._v("\n              编辑\n            ")]),a("el-button",{staticClass:"text-danger",attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.deleteOrg(o)}}},[e._v("\n              删除\n            ")])],1)])])}}],null,!1,1375868236)}):e._e()],1),a("div",{staticClass:"view-footer"}),a("el-dialog",{attrs:{title:"部门组织","close-on-click-modal":!1,visible:e.orgDialogVisible,width:"30%"},on:{"update:visible":function(t){e.orgDialogVisible=t}}},[a("el-form",{ref:"orgForm",attrs:{"label-width":"80px",model:e.orgForm,rules:e.orgRules}},[a("el-form-item",{attrs:{label:"部门名称",prop:"depart_name"}},[a("el-input",{model:{value:e.orgForm.depart_name,callback:function(t){e.$set(e.orgForm,"depart_name",t)},expression:"orgForm.depart_name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.orgDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("orgForm")}}},[e._v("确 定")])],1)],1)],1)},o=[],r={data:function(){return{loading:!1,orgTreeData:[{department_id:1,pid:0,depart_name:"总公司",child:[{department_id:2,pid:1,depart_name:"杭州分公司",child:[{department_id:4,pid:2,depart_name:"下城区分公司"},{department_id:5,pid:2,depart_name:"西湖区分公司1"}]},{department_id:3,pid:1,depart_name:"温州分公司"}]},{department_id:19,pid:0,depart_name:"测试顶级",child:[{department_id:20,pid:19,depart_name:"测试次级"}]}],tempId:null,defaultProps:{children:"child",label:"depart_name"},tempOperateType:"new",orgDialogVisible:!1,orgForm:{depart_name:""},orgRules:{depart_name:[{required:!0,message:"请输入部门名称",trigger:"blur"}]}}},mounted:function(){},methods:{getOrgTreeData:function(){var e=this,t={method:"get",params:{},url:"".concat(this.$common.basePath,"/admin/admin/showDepartment")};this.loading=!0,this.$axios(t).then(function(t){e.orgTreeData=t.data,e.loading=!1}).catch(function(t){e.loading=!1,e.$message.error(t.msg)})},showNodeDialog:function(e,t){var a=this;this.tempOperateType=e,this.orgForm={depart_name:""},"edit"==e?(this.orgForm=this.$common.deepCopy(t),delete this.orgForm.child):t&&(this.orgForm.pid=t.department_id),this.$nextTick(function(e){a.$refs.orgForm.clearValidate()}),this.orgDialogVisible=!0},deleteOrg:function(e){var t=this;this.$confirm("删除后需要再次添加","确认删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(a){var n={method:"get",params:{department_id:e.department_id},url:"".concat(t.$common.basePath,"/admin/admin/deleteDepartment")};t.$axios(n).then(function(e){t.$message.success(e.msg),t.getOrgTreeData(),t.orgDialogVisible=!1}).catch(function(e){t.$message.error(e.msg)})}).catch(function(e){})},submitForm:function(e){var t=this;this.$refs[e].validate(function(a){if(a){var n={method:"post",data:t[e],url:""};"new"==t.tempOperateType?n.url="".concat(t.$common.basePath,"/admin/admin/addDepartment"):n.url="".concat(t.$common.basePath,"/admin/admin/editDepartment"),t.$axios(n).then(function(e){t.$message.success(e.msg),t.getOrgTreeData(),t.orgDialogVisible=!1}).catch(function(e){t.$message.error(e.msg)})}})}}},i=r,d=a("6691"),s=Object(d["a"])(i,n,o,!1,null,null,null);t["default"]=s.exports}}]);